<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AppMenubar.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">view</a> &gt; <a href="index.source.html" class="el_package">com.jsql.view.swing.menubar</a> &gt; <span class="el_source">AppMenubar.java</span></div><h1>AppMenubar.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 * Copyhacked (H) 2012-2025.
 * This program and the accompanying materials
 * are made available under no term at all, use it like
 * you want, but share and discuss it
 * every time possible with every body.
 * 
 * Contributors:
 *      ron190 at ymail dot com - initial implementation
 ******************************************************************************/
package com.jsql.view.swing.menubar;

import com.jsql.util.GitUtil.ShowOnConsole;
import com.jsql.util.I18nUtil;
import com.jsql.util.LogLevelUtil;
import com.jsql.view.swing.action.ActionSaveTab;
import com.jsql.view.swing.action.HotkeyUtil;
import com.jsql.view.swing.console.JTextPaneAppender;
import com.jsql.view.swing.dialog.DialogAbout;
import com.jsql.view.swing.dialog.DialogTranslate;
import com.jsql.view.swing.dialog.translate.Language;
import com.jsql.view.swing.panel.preferences.PanelExploit;
import com.jsql.view.swing.panel.preferences.PanelTampering;
import com.jsql.view.swing.sql.SqlEngine;
import com.jsql.view.swing.table.PanelTable;
import com.jsql.view.swing.text.JPopupTextArea;
import com.jsql.view.swing.util.I18nViewUtil;
import com.jsql.view.swing.util.MediatorHelper;
import com.jsql.view.swing.util.ModelSvgIcon;
import com.jsql.view.swing.util.UiUtil;
import org.apache.commons.lang3.StringUtils;
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;

import javax.swing.*;
import javax.swing.table.JTableHeader;
import javax.swing.table.TableColumnModel;
import javax.swing.text.JTextComponent;
import javax.swing.text.StyleConstants;
import java.awt.*;
import java.awt.event.InputEvent;
import java.awt.event.KeyEvent;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.util.Arrays;
import java.util.List;
import java.util.Locale;
import java.util.stream.Collectors;
import java.util.stream.Stream;

/**
 * Application main menubar.
 */
public class AppMenubar extends JMenuBar {
    
    /**
     * Log4j logger sent to view.
     */
<span class="fc" id="L59">    private static final Logger LOGGER = LogManager.getRootLogger();</span>

    private final MenuWindows menuWindows;

<span class="fc" id="L63">    protected static final List&lt;ModelItemTranslate&gt; MODELS_ITEM = Stream.of(</span>
        Language.EN, Language.FR, Language.RU, Language.ZH, Language.ES, Language.TR, Language.KO, Language.SE, Language.FI,
        Language.AR, Language.CS, Language.IT, Language.PT, Language.PL, Language.IN, Language.NL, Language.RO, Language.DE
<span class="fc" id="L66">    ).map(ModelItemTranslate::new).collect(Collectors.toList());</span>

<span class="fc" id="L68">    private static final List&lt;ModelItemTranslate&gt; MODELS_ITEM_INTO = Stream.of(</span>
        Language.FR, Language.ES, Language.SE, Language.FI, Language.TR, Language.CS, Language.RO, Language.IT, Language.PT, Language.AR,
        Language.PL, Language.RU, Language.ZH, Language.DE, Language.IN, Language.JA, Language.KO, Language.HI, Language.NL, Language.TA
<span class="fc" id="L71">    ).map(ModelItemTranslate::new).collect(Collectors.toList());</span>

    /**
     * Create a menubar on main frame.
     */
<span class="fc" id="L76">    public AppMenubar() {</span>
<span class="fc" id="L77">        this.add(this.initMenuFile());</span>
<span class="fc" id="L78">        this.add(this.initMenuEdit());</span>
<span class="fc" id="L79">        this.add(this.initMenuCommunity());</span>
<span class="fc" id="L80">        this.menuWindows = new MenuWindows(this);</span>
<span class="fc" id="L81">        this.add(this.menuWindows);</span>
<span class="fc" id="L82">        this.add(this.initMenuHelp());</span>
<span class="fc" id="L83">    }</span>

    private JMenu initMenuFile() {
<span class="fc" id="L86">        var menuFile = new JMenu(I18nUtil.valueByKey(&quot;MENUBAR_FILE&quot;));</span>
<span class="fc" id="L87">        I18nViewUtil.addComponentForKey(&quot;MENUBAR_FILE&quot;, menuFile);</span>
<span class="fc" id="L88">        menuFile.setMnemonic('F');</span>

<span class="fc" id="L90">        JMenuItem itemSave = new JMenuItem(new ActionSaveTab());</span>
<span class="fc" id="L91">        I18nViewUtil.addComponentForKey(&quot;MENUBAR_FILE_SAVETABAS&quot;, itemSave);</span>

<span class="fc" id="L93">        JMenuItem itemExit = new JMenuItem(I18nUtil.valueByKey(&quot;MENUBAR_FILE_EXIT&quot;), 'x');</span>
<span class="fc" id="L94">        I18nViewUtil.addComponentForKey(&quot;MENUBAR_FILE_EXIT&quot;, itemExit);</span>
<span class="pc" id="L95">        itemExit.addActionListener(actionEvent -&gt; MediatorHelper.frame().dispose());</span>

<span class="fc" id="L97">        HotkeyUtil.addShortcut(this);</span>

<span class="fc" id="L99">        menuFile.add(itemSave);</span>
<span class="fc" id="L100">        menuFile.add(new JSeparator());</span>
<span class="fc" id="L101">        menuFile.add(itemExit);</span>
<span class="fc" id="L102">        return menuFile;</span>
    }

    private JMenu initMenuEdit() {
<span class="fc" id="L106">        var menuEdit = new JMenu(I18nUtil.valueByKey(&quot;MENUBAR_EDIT&quot;));</span>
<span class="fc" id="L107">        I18nViewUtil.addComponentForKey(&quot;MENUBAR_EDIT&quot;, menuEdit);</span>
<span class="fc" id="L108">        menuEdit.setMnemonic('E');</span>

<span class="fc" id="L110">        JMenuItem itemCopy = new JMenuItem(I18nUtil.valueByKey(&quot;CONTEXT_MENU_COPY&quot;), 'C');</span>
<span class="fc" id="L111">        I18nViewUtil.addComponentForKey(&quot;CONTEXT_MENU_COPY&quot;, itemCopy);</span>
<span class="fc" id="L112">        itemCopy.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_C, InputEvent.CTRL_DOWN_MASK));</span>
<span class="fc" id="L113">        itemCopy.addActionListener(actionEvent -&gt; {</span>
<span class="nc bnc" id="L114" title="All 2 branches missed.">            if (MediatorHelper.tabResults().getSelectedComponent() instanceof PanelTable) {</span>
<span class="nc" id="L115">                ((PanelTable) MediatorHelper.tabResults().getSelectedComponent()).copyTable();</span>
<span class="nc bnc" id="L116" title="All 2 branches missed.">            } else if (MediatorHelper.tabResults().getSelectedComponent() instanceof JScrollPane) {</span>
<span class="nc" id="L117">                ((JTextComponent) ((JScrollPane) MediatorHelper.tabResults().getSelectedComponent()).getViewport().getView()).copy();</span>
            }
<span class="nc" id="L119">        });</span>

<span class="fc" id="L121">        JMenuItem itemSelectAll = new JMenuItem(I18nUtil.valueByKey(&quot;CONTEXT_MENU_SELECT_ALL&quot;), 'A');</span>
<span class="fc" id="L122">        I18nViewUtil.addComponentForKey(&quot;CONTEXT_MENU_SELECT_ALL&quot;, itemSelectAll);</span>
<span class="fc" id="L123">        itemSelectAll.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_A, InputEvent.CTRL_DOWN_MASK));</span>
<span class="fc" id="L124">        itemSelectAll.addActionListener(actionEvent -&gt; {</span>
<span class="nc bnc" id="L125" title="All 2 branches missed.">            if (MediatorHelper.tabResults().getSelectedComponent() instanceof PanelTable) {</span>
<span class="nc" id="L126">                ((PanelTable) MediatorHelper.tabResults().getSelectedComponent()).selectTable();</span>
<span class="nc bnc" id="L127" title="All 2 branches missed.">            } else if (MediatorHelper.tabResults().getSelectedComponent() instanceof JScrollPane) {</span>
                // Textarea need focus to select all
<span class="nc" id="L129">                ((JScrollPane) MediatorHelper.tabResults().getSelectedComponent()).getViewport().getView().requestFocusInWindow();</span>
<span class="nc" id="L130">                ((JTextComponent) ((JScrollPane) MediatorHelper.tabResults().getSelectedComponent()).getViewport().getView()).selectAll();</span>
            }
<span class="nc" id="L132">        });</span>

<span class="fc" id="L134">        menuEdit.add(itemCopy);</span>
<span class="fc" id="L135">        menuEdit.add(new JSeparator());</span>
<span class="fc" id="L136">        menuEdit.add(itemSelectAll);</span>
<span class="fc" id="L137">        return menuEdit;</span>
    }

    private JMenu initMenuCommunity() {
<span class="fc" id="L141">        var menuCommunity = new JMenu(I18nUtil.valueByKey(&quot;MENUBAR_COMMUNITY&quot;));</span>
<span class="fc" id="L142">        menuCommunity.setMnemonic('C');</span>
<span class="fc" id="L143">        menuCommunity.setName(&quot;menuCommunity&quot;);</span>
<span class="fc" id="L144">        I18nViewUtil.addComponentForKey(&quot;MENUBAR_COMMUNITY&quot;, menuCommunity);</span>

<span class="fc" id="L146">        JMenu menuI18nContribution = this.initMenuI18nContribution();</span>
<span class="fc" id="L147">        menuI18nContribution.setName(&quot;menuI18nContribution&quot;);</span>

<span class="fc" id="L149">        JMenuItem itemReportIssue = this.initItemReportIssue();</span>
<span class="fc" id="L150">        itemReportIssue.setName(&quot;itemReportIssue&quot;);</span>

<span class="fc" id="L152">        menuCommunity.add(menuI18nContribution);</span>
<span class="fc" id="L153">        menuCommunity.add(new JSeparator());</span>
<span class="fc" id="L154">        menuCommunity.add(itemReportIssue);</span>
<span class="fc" id="L155">        return menuCommunity;</span>
    }

    private JMenu initMenuI18nContribution() {
<span class="fc" id="L159">        var menuI18nContribution = new JMenu(I18nUtil.valueByKey(&quot;MENUBAR_COMMUNITY_HELPTRANSLATE&quot;));</span>
<span class="fc" id="L160">        I18nViewUtil.addComponentForKey(&quot;MENUBAR_COMMUNITY_HELPTRANSLATE&quot;, menuI18nContribution);</span>

<span class="fc" id="L162">        final var dialogTranslate = new DialogTranslate();  // Render the About dialog behind scene</span>
<span class="fc" id="L163">        AppMenubar.MODELS_ITEM_INTO.forEach(model -&gt; {</span>
<span class="fc" id="L164">            model.setMenuItem(new JMenuItem(model.getLanguage().getMenuItemLabel(), model.getLanguage().getFlag()));</span>
<span class="fc" id="L165">            model.getMenuItem().addActionListener(new ActionTranslate(dialogTranslate, model.getLanguage()));</span>
<span class="fc" id="L166">            menuI18nContribution.add(model.getMenuItem());</span>
<span class="fc" id="L167">        });</span>

<span class="fc" id="L169">        var itemIntoOther = new JMenuItem(I18nUtil.valueByKey(&quot;MENUBAR_COMMUNITY_ANOTHERLANGUAGE&quot;));</span>
<span class="fc" id="L170">        I18nViewUtil.addComponentForKey(&quot;MENUBAR_COMMUNITY_ANOTHERLANGUAGE&quot;, itemIntoOther);</span>

<span class="fc bfc" id="L172" title="All 2 branches covered.">        AppMenubar.MODELS_ITEM_INTO.stream().filter(model -&gt; model.getLanguage() == Language.AR)</span>
<span class="fc" id="L173">        .forEach(modelItemTranslate -&gt; modelItemTranslate.getMenuItem().setComponentOrientation(ComponentOrientation.RIGHT_TO_LEFT));</span>
<span class="fc bfc" id="L174" title="All 2 branches covered.">        AppMenubar.MODELS_ITEM_INTO.stream().filter(model -&gt; model.getLanguage() == Language.FR)</span>
<span class="fc" id="L175">        .forEach(modelItemTranslate -&gt; modelItemTranslate.getMenuItem().setName(&quot;itemIntoFrench&quot;));</span>

<span class="fc" id="L177">        menuI18nContribution.add(new JSeparator());</span>
<span class="fc" id="L178">        menuI18nContribution.add(itemIntoOther);</span>
<span class="fc" id="L179">        itemIntoOther.addActionListener(new ActionTranslate(dialogTranslate, Language.OT));</span>

<span class="fc" id="L181">        return menuI18nContribution;</span>
    }

    private JMenuItem initItemReportIssue() {
<span class="fc" id="L185">        JMenuItem itemReportIssue = new JMenuItem(I18nUtil.valueByKey(&quot;MENUBAR_COMMUNITY_REPORTISSUE&quot;), 'R');</span>
<span class="fc" id="L186">        I18nViewUtil.addComponentForKey(&quot;MENUBAR_COMMUNITY_REPORTISSUE&quot;, itemReportIssue);</span>

<span class="fc" id="L188">        itemReportIssue.addActionListener(actionEvent -&gt; {</span>

<span class="nc" id="L190">            var panel = new JPanel(new BorderLayout());</span>
<span class="nc" id="L191">            final JTextArea textarea = new JPopupTextArea(new JTextArea()).getProxy();</span>
<span class="nc" id="L192">            textarea.setFont(new Font(</span>
                UiUtil.FONT_NAME_MONOSPACED,
                Font.PLAIN,
<span class="nc" id="L195">                UIManager.getDefaults().getFont(&quot;TextField.font&quot;).getSize()</span>
            ));
<span class="nc" id="L197">            textarea.setText(</span>
                &quot;## What's the expected behavior?\n\n&quot;
                + &quot;## What's the actual behavior?\n\n&quot;
                + &quot;## Any other detailed information on the Issue?\n\n&quot;
                + &quot;## Steps to reproduce the problem\n\n&quot;
                + &quot;  1. ...\n&quot;
                + &quot;  2. ...\n\n&quot;
                + &quot;## [Community] Request for new feature\n\n&quot;
            );
<span class="nc" id="L206">            panel.add(new JLabel(&quot;Describe your bug or issue:&quot;), BorderLayout.NORTH);</span>
<span class="nc" id="L207">            panel.add(new JScrollPane(textarea));</span>
<span class="nc" id="L208">            panel.setPreferredSize(new Dimension(500, 350));</span>
<span class="nc" id="L209">            panel.setMinimumSize(new Dimension(500, 350));</span>

<span class="nc" id="L211">            textarea.addMouseListener(new MouseAdapter() {</span>
                @Override
                public void mousePressed(MouseEvent e) {
<span class="nc" id="L214">                    super.mousePressed(e);</span>
<span class="nc" id="L215">                    textarea.requestFocusInWindow();</span>
<span class="nc" id="L216">                }</span>
            });

<span class="nc" id="L219">            int result = JOptionPane.showOptionDialog(</span>
<span class="nc" id="L220">                MediatorHelper.frame(),</span>
                panel,
                &quot;Report an issue or a bug&quot;,
                JOptionPane.OK_CANCEL_OPTION,
                JOptionPane.QUESTION_MESSAGE,
                null,
                new String[] {
                    &quot;Send&quot;,
<span class="nc" id="L228">                    I18nUtil.valueByKey(&quot;LIST_ADD_VALUE_CANCEL&quot;)</span>
                },
<span class="nc" id="L230">                I18nUtil.valueByKey(&quot;LIST_ADD_VALUE_CANCEL&quot;)</span>
            );

<span class="nc bnc" id="L233" title="All 4 branches missed.">            if (StringUtils.isNotEmpty(textarea.getText()) &amp;&amp; result == JOptionPane.YES_OPTION) {</span>
<span class="nc" id="L234">                MediatorHelper.model().getMediatorUtils().getGitUtil().sendReport(textarea.getText(), ShowOnConsole.YES, &quot;Report&quot;);</span>
            }
<span class="nc" id="L236">        });</span>

<span class="fc" id="L238">        return itemReportIssue;</span>
    }

    private JMenu initMenuHelp() {
<span class="fc" id="L242">        var menuHelp = new JMenu(I18nUtil.valueByKey(&quot;MENUBAR_HELP&quot;));</span>
<span class="fc" id="L243">        menuHelp.setMnemonic('H');</span>
<span class="fc" id="L244">        I18nViewUtil.addComponentForKey(&quot;MENUBAR_HELP&quot;, menuHelp);</span>
<span class="fc" id="L245">        menuHelp.setName(&quot;menuHelp&quot;);</span>

<span class="fc" id="L247">        JMenuItem itemHelp = new JMenuItem(I18nUtil.valueByKey(&quot;MENUBAR_HELP_ABOUT&quot;), 'A');</span>
<span class="fc" id="L248">        I18nViewUtil.addComponentForKey(&quot;MENUBAR_HELP_ABOUT&quot;, itemHelp);</span>
<span class="fc" id="L249">        itemHelp.setName(&quot;itemHelp&quot;);</span>

<span class="fc" id="L251">        JMenuItem itemUpdate = new JMenuItem(I18nUtil.valueByKey(&quot;MENUBAR_HELP_UPDATE&quot;), 'U');</span>
<span class="fc" id="L252">        I18nViewUtil.addComponentForKey(&quot;MENUBAR_HELP_UPDATE&quot;, itemUpdate);</span>

        // Render the About dialog behind scene
<span class="fc" id="L255">        itemHelp.addActionListener(actionEvent -&gt; {</span>
<span class="fc" id="L256">            final var dialogAbout = new DialogAbout();</span>
<span class="pc bpc" id="L257" title="1 of 2 branches missed.">            if (!dialogAbout.isVisible()) {</span>
<span class="fc" id="L258">                dialogAbout.initDialog();</span>
<span class="fc" id="L259">                dialogAbout.setVisible(true);  // needed here for button focus</span>
<span class="fc" id="L260">                dialogAbout.requestButtonFocus();</span>
            }
<span class="fc" id="L262">            dialogAbout.setVisible(true);</span>
<span class="fc" id="L263">        });</span>
<span class="fc" id="L264">        itemUpdate.addActionListener(new ActionCheckUpdate());</span>

<span class="fc" id="L266">        menuHelp.add(itemUpdate);</span>
<span class="fc" id="L267">        menuHelp.add(new JSeparator());</span>
<span class="fc" id="L268">        menuHelp.add(itemHelp);</span>
<span class="fc" id="L269">        return menuHelp;</span>
    }

    public static void applyTheme(String theme) {
<span class="fc" id="L273">        UiUtil.applyTheme(theme);</span>

<span class="fc" id="L275">        Arrays.asList(</span>
            UiUtil.DATABASE_BOLD, UiUtil.ADMIN, UiUtil.DOWNLOAD, UiUtil.TERMINAL, UiUtil.UPLOAD, UiUtil.LOCK, UiUtil.TEXTFIELD, UiUtil.BATCH,
            UiUtil.TABLE_LINEAR, UiUtil.TABLE_BOLD, UiUtil.NETWORK, UiUtil.DATABASE_LINEAR, UiUtil.COG, UiUtil.CUP, UiUtil.CONSOLE, UiUtil.BINARY, UiUtil.CHUNK,
            UiUtil.ARROW, UiUtil.ARROW_HOVER, UiUtil.ARROW_PRESSED, UiUtil.EXPAND, UiUtil.EXPAND_HOVER, UiUtil.EXPAND_PRESSED,
            UiUtil.HOURGLASS, UiUtil.ARROW_DOWN, UiUtil.ARROW_UP, UiUtil.SQUARE, UiUtil.GLOBE, UiUtil.TICK_GREEN, UiUtil.CROSS_RED,
            UiUtil.APP_ICON, UiUtil.APP_BIG, UiUtil.APP_MIDDLE
<span class="fc" id="L281">        ).forEach(ModelSvgIcon::setColorFilter);</span>

<span class="fc" id="L283">        SqlEngine.applyTheme();</span>
<span class="fc" id="L284">        PanelTampering.applyTheme();</span>
<span class="fc" id="L285">        PanelExploit.applyTheme();</span>
<span class="fc" id="L286">        MediatorHelper.panelConsoles().getTabbedPaneNetworkTab().applyTheme();</span>
<span class="fc" id="L287">        MediatorHelper.frame().setIconImages(UiUtil.getIcons());</span>
<span class="fc" id="L288">        MediatorHelper.frame().revalidate();</span>

<span class="fc" id="L290">        MediatorHelper.model().getMediatorUtils().getPreferencesUtil().withThemeFlatLafName(theme).persist();</span>
<span class="fc" id="L291">    }</span>
    
    public void switchLocale(Locale newLocale) {
<span class="fc" id="L294">        this.switchLocale(I18nUtil.getCurrentLocale(), newLocale, false);</span>
<span class="fc" id="L295">    }</span>
    
    public void switchLocaleWithStatus(Locale oldLocale, Locale newLocale, boolean isStartup) {
<span class="nc" id="L298">        this.switchLocale(oldLocale, newLocale, isStartup);</span>
<span class="nc" id="L299">        MediatorHelper.model().getPropertiesUtil().displayStatus(newLocale);</span>
<span class="nc" id="L300">    }</span>

    public void switchLocale(Locale oldLocale, Locale newLocale, boolean isStartup) {
<span class="fc" id="L303">        I18nUtil.setCurrentBundle(newLocale);</span>

<span class="fc" id="L305">        Stream.of(</span>
            JTextPaneAppender.ATTRIBUTE_WARN,
            JTextPaneAppender.ATTRIBUTE_INFORM,
            JTextPaneAppender.ATTRIBUTE_SUCCESS,
            JTextPaneAppender.ATTRIBUTE_ALL
        )
<span class="fc" id="L311">        .forEach(attribute -&gt; {</span>
<span class="pc bpc" id="L312" title="1 of 2 branches missed.">            StyleConstants.setFontFamily(attribute, I18nViewUtil.isNonUbuntu(newLocale) ? UiUtil.FONT_NAME_MONO_ASIAN : UiUtil.FONT_NAME_MONO_NON_ASIAN);</span>
<span class="pc bpc" id="L313" title="1 of 2 branches missed.">            StyleConstants.setFontSize(attribute, I18nViewUtil.isNonUbuntu(newLocale) ? UiUtil.FONT_SIZE_MONO_ASIAN : UiUtil.FONT_SIZE_MONO_NON_ASIAN);</span>
<span class="fc" id="L314">        });</span>

<span class="pc bpc" id="L316" title="1 of 2 branches missed.">        MediatorHelper.managerBruteForce().getResult().setFont(I18nViewUtil.isNonUbuntu(newLocale) ? UiUtil.FONT_MONO_ASIAN : UiUtil.FONT_MONO_NON_ASIAN);</span>

<span class="fc" id="L318">        this.switchNetworkTable();</span>
<span class="fc" id="L319">        I18nViewUtil.switchI18nComponents();</span>
<span class="fc" id="L320">        this.switchOrientation(oldLocale, newLocale, isStartup);</span>
<span class="fc" id="L321">        this.switchMenuItems();  // required to restore proper language orientation</span>
        
<span class="fc" id="L323">        MediatorHelper.treeDatabase().reloadNodes();</span>

        // IllegalArgumentException #92981 on revalidate()
        try {
<span class="fc" id="L327">            MediatorHelper.frame().revalidate();  // Fix glitches on Linux</span>
<span class="nc" id="L328">        } catch (IllegalArgumentException e) {</span>
<span class="nc" id="L329">            LOGGER.log(LogLevelUtil.CONSOLE_JAVA, e, e);</span>
<span class="fc" id="L330">        }</span>
<span class="fc" id="L331">    }</span>

    private void switchOrientation(Locale oldLocale, Locale newLocale, boolean isStartup) {
<span class="fc" id="L334">        var componentOrientation = ComponentOrientation.getOrientation(I18nUtil.getCurrentLocale());</span>
<span class="fc" id="L335">        MediatorHelper.frame().applyComponentOrientation(componentOrientation);</span>
        
<span class="pc bpc" id="L337" title="1 of 2 branches missed.">        if (!ComponentOrientation.getOrientation(oldLocale).equals(ComponentOrientation.getOrientation(newLocale))) {</span>
            
<span class="nc" id="L339">            JSplitPane splitPaneLeftRight = MediatorHelper.frame().getSplitNS().getSplitEW();</span>
<span class="nc" id="L340">            var componentLeft = splitPaneLeftRight.getLeftComponent();</span>
<span class="nc" id="L341">            var componentRight = splitPaneLeftRight.getRightComponent();</span>

            // Reset components
<span class="nc" id="L344">            splitPaneLeftRight.setLeftComponent(null);</span>
<span class="nc" id="L345">            splitPaneLeftRight.setRightComponent(null);</span>
<span class="nc" id="L346">            splitPaneLeftRight.setLeftComponent(componentRight);</span>
<span class="nc" id="L347">            splitPaneLeftRight.setRightComponent(componentLeft);</span>

<span class="nc bnc" id="L349" title="All 2 branches missed.">            if (isStartup) {</span>
                // TODO unclear and not working properly when starting as locale arabic
<span class="nc" id="L351">                splitPaneLeftRight.setDividerLocation(</span>
<span class="nc" id="L352">                    splitPaneLeftRight.getDividerLocation()</span>
                );
            } else {  // required as switch to arabic uses reversed location
<span class="nc" id="L355">                splitPaneLeftRight.setDividerLocation(</span>
<span class="nc" id="L356">                    splitPaneLeftRight.getWidth() -</span>
<span class="nc" id="L357">                    splitPaneLeftRight.getDividerLocation()</span>
                );
            }
        }
        
<span class="fc" id="L362">        MediatorHelper.tabResults().setComponentOrientation(ComponentOrientation.getOrientation(newLocale));</span>
<span class="fc" id="L363">    }</span>

    private void switchMenuItems() {
<span class="fc" id="L366">        Stream.concat(AppMenubar.MODELS_ITEM.stream(), AppMenubar.MODELS_ITEM_INTO.stream())</span>
<span class="fc" id="L367">        .forEach(model -&gt; model.getMenuItem().setComponentOrientation(</span>
<span class="fc bfc" id="L368" title="All 2 branches covered.">            model.getLanguage().isRightToLeft()</span>
<span class="fc" id="L369">            ? ComponentOrientation.RIGHT_TO_LEFT</span>
<span class="fc" id="L370">            : ComponentOrientation.LEFT_TO_RIGHT</span>
        ));
<span class="fc" id="L372">    }</span>

    private void switchNetworkTable() {
<span class="fc" id="L375">        JTableHeader header = MediatorHelper.panelConsoles().getNetworkTable().getTableHeader();</span>
<span class="fc" id="L376">        TableColumnModel columnModel = header.getColumnModel();</span>
<span class="fc" id="L377">        columnModel.getColumn(0).setHeaderValue(I18nUtil.valueByKey(&quot;NETWORK_TAB_URL_COLUMN&quot;));</span>
<span class="fc" id="L378">        columnModel.getColumn(1).setHeaderValue(I18nUtil.valueByKey(&quot;NETWORK_TAB_SIZE_COLUMN&quot;) +&quot; (KB)&quot;);</span>
<span class="fc" id="L379">        columnModel.getColumn(2).setHeaderValue(I18nUtil.valueByKey(&quot;SQLENGINE_STRATEGY&quot;));</span>
<span class="fc" id="L380">        columnModel.getColumn(3).setHeaderValue(I18nUtil.valueByKey(&quot;SQLENGINE_METADATA&quot;));</span>
<span class="fc" id="L381">        header.repaint();</span>
<span class="fc" id="L382">    }</span>
    
    
    // Getter and setter

    public JMenu getMenuView() {
<span class="nc" id="L388">        return this.menuWindows.getMenuView();</span>
    }

    public MenuWindows getMenuWindows() {
<span class="fc" id="L392">        return this.menuWindows;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>