<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Seal.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">model</a> &gt; <a href="index.source.html" class="el_package">com.jsql.view.subscriber</a> &gt; <span class="el_source">Seal.java</span></div><h1>Seal.java</h1><pre class="source lang-java linenums">package com.jsql.view.subscriber;

import com.jsql.model.bean.database.AbstractElementDatabase;
import com.jsql.model.bean.database.Column;
import com.jsql.model.bean.database.Database;
import com.jsql.model.bean.database.Table;
import com.jsql.model.injection.strategy.AbstractStrategy;
import com.jsql.model.injection.strategy.blind.callable.AbstractCallableBit;
import com.jsql.model.injection.engine.model.Engine;
import org.apache.logging.log4j.util.Strings;

import java.util.*;
import java.util.function.BiConsumer;

public sealed interface Seal permits
    Seal.AddColumns,
    Seal.AddDatabases,
    Seal.AddTables,
    Seal.CreateValuesTab,

    Seal.MarkEngineFound,
    Seal.ActivateEngine,

    Seal.MarkStrategyInvulnerable,
    Seal.MarkStrategyVulnerable,
    Seal.ActivateStrategy,

    Seal.MarkFileSystemInvulnerable,
    Seal.MarkFileSystemVulnerable,

    Seal.MessageBinary,
    Seal.MessageChunk,
    Seal.MessageHeader,

    Seal.AddTabExploitSql,
    Seal.AddTabExploitUdf,
    Seal.AddTabExploitWeb,
    Seal.GetTerminalResult,

    Seal.CreateAdminPageTab,
    Seal.CreateAnalysisReport,
    Seal.CreateFileTab,

    Seal.EndIndeterminateProgress,
    Seal.EndPreparation,
    Seal.EndProgress,
    Seal.StartIndeterminateProgress,
    Seal.StartProgress,
    Seal.UpdateProgress {

<span class="fc" id="L51">    record AddColumns(List&lt;Column&gt; columns) implements Seal {}</span>
<span class="fc" id="L52">    record AddDatabases(List&lt;Database&gt; databases) implements Seal {}</span>
<span class="fc" id="L53">    record AddTables(List&lt;Table&gt; tables) implements Seal {}</span>
<span class="fc" id="L54">    record CreateValuesTab(String[] columns, String[][] table, Table tableBean) implements Seal {</span>

        @Override
        public boolean equals(Object o) {
<span class="nc bnc" id="L58" title="All 4 branches missed.">            if (o == null || this.getClass() != o.getClass()) return false;</span>
<span class="nc" id="L59">            CreateValuesTab that = (CreateValuesTab) o;</span>
<span class="nc bnc" id="L60" title="All 6 branches missed.">            return Objects.equals(this.tableBean, that.tableBean) &amp;&amp; Objects.deepEquals(this.columns, that.columns) &amp;&amp; Objects.deepEquals(this.table, that.table);</span>
        }

        @Override
        public int hashCode() {
<span class="nc" id="L65">            return Objects.hash(Arrays.hashCode(this.columns), Arrays.deepHashCode(this.table), this.tableBean);</span>
        }

        @Override
        public String toString() {
<span class="nc" id="L70">            return &quot;CreateValuesTab{&quot; +</span>
<span class="nc" id="L71">                &quot;columns=&quot; + Arrays.toString(columns) +</span>
<span class="nc" id="L72">                &quot;, table=&quot; + Arrays.toString(table) +</span>
                &quot;, tableBean=&quot; + tableBean +
            '}';
        }
    }

    /** End the refreshing of administration page search button */
<span class="fc" id="L79">    record MarkEngineFound(Engine engine) implements Seal {}</span>
<span class="fc" id="L80">    record ActivateEngine(Engine engine) implements Seal {}</span>

<span class="fc" id="L82">    record MarkStrategyInvulnerable(int indexError, AbstractStrategy strategy) implements Seal {</span>
        public MarkStrategyInvulnerable(AbstractStrategy strategy) {
<span class="fc" id="L84">            this(-1, strategy);</span>
<span class="fc" id="L85">        }</span>
    }
<span class="fc" id="L87">    record MarkStrategyVulnerable(int indexError, AbstractStrategy strategy) implements Seal {</span>
        public MarkStrategyVulnerable(AbstractStrategy strategy) {
<span class="fc" id="L89">            this(-1, strategy);</span>
<span class="fc" id="L90">        }</span>
    }
<span class="fc" id="L92">    record ActivateStrategy(AbstractStrategy strategy) implements Seal {}</span>

<span class="nc" id="L94">    record MarkFileSystemInvulnerable() implements Seal {}</span>
<span class="fc" id="L95">    record MarkFileSystemVulnerable() implements Seal {}</span>

<span class="fc" id="L97">    record MessageChunk(String message) implements Seal {}</span>
<span class="fc" id="L98">    record MessageBinary(String message) implements Seal {}</span>
    record MessageHeader(
        String url,
        String post,
        Map&lt;String, String&gt; header,
        Map&lt;String, String&gt; response,
        String source,
        String size,
        String metadataStrategy,
        String metadataProcess,
        AbstractCallableBit&lt;?&gt; metadataBoolean
    ) implements Seal {
        public MessageHeader(
            String url,
            String post,
            Map&lt;String, String&gt; header,
            Map&lt;String, String&gt; response,
            String source,
            String size,
            String metadataStrategy,
            String metadataProcess,
            AbstractCallableBit&lt;?&gt; metadataBoolean
<span class="fc" id="L120">        ) {</span>
<span class="pc bpc" id="L121" title="1 of 2 branches missed.">            this.url = url == null ? Strings.EMPTY : url;</span>
<span class="fc bfc" id="L122" title="All 2 branches covered.">            this.post = post == null ? Strings.EMPTY : post;</span>
<span class="pc bpc" id="L123" title="1 of 2 branches missed.">            this.header = header == null ? Collections.emptyMap() : header;</span>
<span class="pc bpc" id="L124" title="1 of 2 branches missed.">            this.response = response == null ? Collections.emptyMap() : response;</span>
<span class="fc bfc" id="L125" title="All 2 branches covered.">            this.source = source == null ? Strings.EMPTY : source;</span>
<span class="fc bfc" id="L126" title="All 2 branches covered.">            this.size = size == null ? Strings.EMPTY : size;</span>
<span class="fc bfc" id="L127" title="All 2 branches covered.">            this.metadataStrategy = metadataStrategy == null ? Strings.EMPTY : metadataStrategy;</span>
<span class="fc bfc" id="L128" title="All 2 branches covered.">            this.metadataProcess = metadataProcess == null ? Strings.EMPTY : metadataProcess;</span>
<span class="fc" id="L129">            this.metadataBoolean = metadataBoolean;</span>
<span class="fc" id="L130">        }</span>
    }

<span class="fc" id="L133">    record AddTabExploitSql(String urlSuccess, String username, String password) implements Seal {}</span>
<span class="fc" id="L134">    record AddTabExploitUdf(BiConsumer&lt;String, UUID&gt; biConsumerRunCmd) implements Seal {}</span>
<span class="fc" id="L135">    record AddTabExploitWeb(String urlSuccess) implements Seal {}</span>
<span class="fc" id="L136">    record GetTerminalResult(UUID uuidShell, String result) implements Seal {}</span>

<span class="fc" id="L138">    record CreateAdminPageTab(String urlSuccess) implements Seal {}</span>
<span class="fc" id="L139">    record CreateAnalysisReport(String content) implements Seal {}</span>
<span class="fc" id="L140">    record CreateFileTab(String name, String content, String path) implements Seal {}</span>

<span class="fc" id="L142">    record EndIndeterminateProgress(Table table) implements Seal {}</span>
<span class="fc" id="L143">    record EndPreparation() implements Seal {}</span>
<span class="fc" id="L144">    record EndProgress(AbstractElementDatabase elementDatabase) implements Seal {}</span>
<span class="fc" id="L145">    record StartIndeterminateProgress(Table table) implements Seal {}</span>
<span class="fc" id="L146">    record StartProgress(AbstractElementDatabase elementDatabase) implements Seal {}</span>
<span class="fc" id="L147">    record UpdateProgress(AbstractElementDatabase elementDatabase, int countProgress) implements Seal {}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>